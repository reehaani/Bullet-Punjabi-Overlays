<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kick Sub Goal - Dock</title>
    <style>
        /* === Modern Design === */
        @import url('https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@400;700;900&display=swap');

        @property --star-color {
            syntax: '<color>';
            inherits: true;
            initial-value: #0aff0a;
        }

        @property --star-color-soft {
            syntax: '<color>';
            inherits: true;
            initial-value: rgba(10, 255, 10, 0.1);
        }

        @property --star-color-secondary {
            syntax: '<color>';
            inherits: true;
            initial-value: rgba(31, 186, 255, 1);
        }

        @property --star-color-secondary-soft {
            syntax: '<color>';
            inherits: true;
            initial-value: rgba(31, 186, 255, 0.14);
        }

        @property --star-secondary-offset {
            syntax: '<angle>';
            inherits: true;
            initial-value: 120deg;
        }

        :root {
            /* === Color Group 3: Progress Bar Fill === */
            --fill-start: rgba(5, 60, 50, 0.95);
            --fill-mid: rgba(10, 100, 80, 0.95);
            --fill-mid2: rgba(30, 170, 80, 0.95);
            --fill-end: rgba(50, 220, 100, 0.95);
            --label-hue-glow: rgba(56, 239, 125, 0.18);
            --bar-fill-bg: linear-gradient(to right, var(--fill-start), var(--fill-mid) 40%, var(--fill-mid2) 75%, var(--fill-end));

            /* === Color Group 2: Accent / Star Border === */
            --star-color: #0aff0a;
            --star-color-soft: rgba(10, 255, 10, 0.1);
            --star-color-secondary: rgba(31, 186, 255, 1);
            --star-color-secondary-soft: rgba(31, 186, 255, 0.14);
            --star-secondary-offset: 120deg;
            --border-glow-color: rgba(10, 255, 10, 0.4);

            /* === Layout & Anim === */
            --border-bg: rgba(0, 0, 0, 0.85);
            --inner-bg: rgb(12, 12, 12);
            --inner-bg-top: rgba(18, 18, 18, 0.985);
            --inner-bg-mid: rgba(10, 10, 10, 0.97);
            --inner-bg-bottom: rgba(6, 6, 6, 0.99);
            --spin-speed: 10s;
            --border-glow-size: 12px;
            --gloss-intensity: 1;
            --rim-light-intensity: 1;
            transition:
                --star-color 320ms linear,
                --star-color-soft 320ms linear,
                --star-color-secondary 320ms linear,
                --star-color-secondary-soft 320ms linear,
                --star-secondary-offset 320ms ease;
        }

        * {
            box-sizing: border-box;
            transition: background-color 1s ease, color 1s ease, border-color 1s ease, box-shadow 1s ease;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            background: transparent;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
        }

        /* === Dock — includes inverse curve zones === */
        .dock-anchor {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 650px;
            height: 70px;
            filter: drop-shadow(0 -5px 18px rgba(0, 0, 0, 0.56));
        }

        /* === Star Border Wrapper ===
             Fixed wrapper clipped to dock shape. Stays still.
             The spinning gradient child rotates freely inside it.
             This mirrors how kick-subs-goal.html uses overflow:hidden on the container. */
        .star-border-wrapper {
            position: absolute;
            inset: 0;
            clip-path: url(#dock-outer);
            z-index: 1;
            overflow: hidden;
        }

        /* The spinning gradient — NOT clipped, just spins inside wrapper */
        .star-border {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 1400px;
            height: 1400px;
            margin-left: -700px;
            margin-top: -700px;
            background: conic-gradient(from 0deg,
                    transparent 0deg,
                    var(--star-color-soft) 8deg,
                    var(--star-color) 30deg,
                    var(--star-color-soft) 52deg,
                    transparent 62deg,
                    transparent 360deg);
            animation: spin var(--spin-speed) linear infinite;
            /* Precise masking: Hide only the center 'wick' origin */
            -webkit-mask-image: radial-gradient(circle, transparent 20px, black 25px);
            mask-image: radial-gradient(circle, transparent 20px, black 25px);
        }

        .star-border::before {
            content: '';
            position: absolute;
            inset: 0;
            background: conic-gradient(from 0deg,
                    transparent 0deg,
                    var(--star-color-secondary-soft) 8deg,
                    var(--star-color-secondary) 30deg,
                    var(--star-color-secondary-soft) 52deg,
                    transparent 62deg,
                    transparent 360deg);
            transform: rotate(var(--star-secondary-offset));
            z-index: 2;
        }

        .star-border::after {
            content: '';
            position: absolute;
            inset: 0;
            background: inherit;
            filter: blur(20px);
            opacity: 0.8;
            z-index: 1;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* === Inner Shape (the fill) ===
             Also full 650x70, but clipped to a 3px-inset version of the dock shape.
             Covers the outer-shape, leaving a 3px border visible all around. */
        .inner-shape {
            position: absolute;
            inset: 0;
            clip-path: url(#dock-inner);
            background:
                linear-gradient(180deg,
                    var(--inner-bg-top) 0%,
                    var(--inner-bg-mid) 46%,
                    var(--inner-bg-bottom) 100%);
            z-index: 2;
            overflow: hidden;
            -webkit-backdrop-filter: none;
            backdrop-filter: none;
            /* Thin black border like the rectangle overlay */
            box-shadow:
                inset 0 0 0 1px rgba(0, 0, 0, 0.9),
                inset 0 1px 0 rgba(255, 255, 255, 0.045);
        }

        /* === Glossy / Glass overlay === */
        .glass-overlay {
            position: absolute;
            inset: 0;
            clip-path: url(#dock-inner);
            /* Minimal realistic gloss */
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.15) 0%,
                    rgba(255, 255, 255, 0.06) 26%,
                    transparent 40%,
                    rgba(0, 0, 0, 0.08) 100%);
            z-index: 15;
            pointer-events: none;
            filter: brightness(calc(0.92 + (var(--gloss-intensity, 1) * 0.08))) contrast(calc(0.94 + (var(--gloss-intensity, 1) * 0.06)));
            opacity: calc(0.2 + (0.3 * var(--gloss-intensity, 1)));
        }

        /* === SVG Rim Light Layer === */
        .rim-light-layer {
            position: absolute;
            inset: 0;
            z-index: 25;
            pointer-events: none;
            opacity: var(--rim-light-intensity, 1);
            -webkit-mask-image: linear-gradient(to bottom, #000 0%, #000 62%, transparent 86%, transparent 100%);
            mask-image: linear-gradient(to bottom, #000 0%, #000 62%, transparent 86%, transparent 100%);
        }

        .rim-light-layer svg {
            width: 100%;
            height: 100%;
            overflow: visible;
        }

        .rim-path {
            fill: none;
            /* Defined inline for gradient support */
        }

        /* === Progress Fill === */
        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: var(--bar-fill-bg);
            transition: width 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 3;
            overflow: hidden;
        }

        /* Metallic top shimmer (static — subtle, not overpowering) */
        .progress-fill::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.15) 0%,
                    rgba(255, 255, 255, 0.03) 25%,
                    transparent 50%,
                    rgba(0, 0, 0, 0.2) 100%);
            z-index: 1;
            /* Rim Light Effect: Sharp top highlight + soft inner glow */
            box-shadow:
                inset 0 2px 2px rgba(255, 255, 255, 0.4),
                inset 0 -2px 4px rgba(0, 0, 0, 0.3),
                inset 0 0 15px var(--neon-green-accent);
        }

        /* Moving shine sweep */
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 60%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.02) 30%,
                    rgba(255, 255, 255, 0.12) 50%,
                    rgba(255, 255, 255, 0.02) 70%,
                    transparent 100%);
            animation: shine-sweep 3s ease-in-out infinite;
            z-index: 2;
        }

        @keyframes shine-sweep {
            0% {
                left: -100%;
            }

            100% {
                left: 200%;
            }
        }

        /* Glow on end of bar */
        .fill-glow {
            position: absolute;
            right: -10px;
            top: 0;
            height: 100%;
            width: 20px;
            background: var(--star-color);
            filter: blur(10px);
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 4;
        }

        .fill-active .fill-glow {
            opacity: 0.8;
        }

        /* === Labels & Text === */
        .content-wrapper {
            position: absolute;
            inset: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 65px;
            z-index: 20;
            pointer-events: none;
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .content-wrapper.completed {
            justify-content: center;
            gap: 20px;
            padding: 0;
            /* Remove padding to allow true mathematical center */
            /* Removed translateY to keep labels on the midline */
        }

        .label-group {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-shrink: 0;
            white-space: nowrap;
        }

        .label {
            font-size: 36px;
            font-weight: 900;
            letter-spacing: 2px;
            text-transform: uppercase;
            /* Keep silver metallic with subtle hue tint */
            background: linear-gradient(180deg,
                    #ffffff 0%, #ffffff 20%,
                    #e0e0e0 40%, #a0a0a0 55%,
                    #c8c8c8 70%, #ffffff 85%, #e0e0e0 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            -webkit-text-stroke: 1.5px rgba(255, 255, 255, 0.5);
            filter:
                drop-shadow(0 2px 4px rgba(0, 0, 0, 1)) drop-shadow(0 0 10px var(--label-hue-glow));
            transition: all 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .content-wrapper.completed .label {
            /* Gold Plated Gradient */
            background: linear-gradient(180deg,
                    #ffed8a 0%,
                    #fcd04d 25%,
                    #d4af37 50%,
                    #8a6d3b 75%,
                    #d4af37 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-stroke: 1.5px rgba(255, 230, 0, 0.4);
            filter:
                drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8)) drop-shadow(0 0 20px rgba(212, 175, 55, 0.8)) drop-shadow(0 0 40px rgba(255, 215, 0, 0.4));
        }

        .completed-tag {
            font-family: 'Anton', sans-serif;
            font-size: 36px;
            color: #000;
            /* Black text on gold tag */
            background: linear-gradient(135deg, #ffed8a, #d4af37, #8a6d3b);
            padding: 2px 15px;
            border-radius: 8px;
            text-transform: uppercase;
            display: none;
            animation: tag-pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) both;
            box-shadow:
                0 0 20px rgba(212, 175, 55, 0.8),
                0 0 40px rgba(255, 230, 0, 0.4);
            white-space: nowrap;
            flex-shrink: 0;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes tag-pop {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .numbers {
            font-family: 'Anton', sans-serif;
            font-size: 38px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: -5px;
        }

        .content-wrapper.completed .numbers {
            position: absolute;
            top: -55px;
            /* Position centered above the progress bar */
            left: 50%;
            transform: translateX(-50%);
            display: flex !important;
            opacity: 1 !important;
        }

        .content-wrapper.completed .numbers span {
            /* Apply Gold Plated Gradient to numbers when completed */
            background: linear-gradient(180deg,
                    #ffed8a 0%,
                    #fcd04d 25%,
                    #d4af37 50%,
                    #8a6d3b 75%,
                    #d4af37 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            -webkit-text-stroke: 1px rgba(255, 230, 0, 0.4);
            filter:
                drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8)) drop-shadow(0 0 15px rgba(212, 175, 55, 0.8)) drop-shadow(0 0 30px rgba(255, 215, 0, 0.4));
        }

        .current-val,
        .target-val {
            /* Metallic gradient applied directly to spans for animation stability */
            background: linear-gradient(180deg,
                    #ffffff 0%, #ffffff 20%,
                    #e0e0e0 40%, #a0a0a0 55%,
                    #c8c8c8 70%, #ffffff 85%, #e0e0e0 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            -webkit-text-stroke: 1.5px rgba(255, 255, 255, 0.5);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1)) drop-shadow(0 0 12px rgba(255, 255, 255, 0.25));
            display: inline-block;
            will-change: transform, filter;
        }

        .current-val {
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.3);
        }

        .divider {
            font-size: 24px;
            opacity: 0.6;
            color: #fff;
            -webkit-background-clip: initial;
            background-clip: initial;
            -webkit-text-stroke: 0;
        }

        .target-val {
            opacity: 0.8;
            font-size: 30px;
        }

        /* High Intensity Visual Pop — Spam Friendly */
        .current-flash {
            animation: current-pop 0.8s cubic-bezier(0.16, 1, 0.3, 1) both !important;
        }

        @keyframes current-pop {
            0% {
                /* Avoid brightness(5) as it often breaks background-clip: text in Chrome */
                /* Use white drop-shadow and stroke to create the 'flash' effect */
                filter: drop-shadow(0 0 20px #fff) drop-shadow(0 0 40px #fff);
                transform: scale(1.15);
                -webkit-text-stroke: 2px #fff;
            }

            100% {
                filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1)) drop-shadow(0 0 12px rgba(255, 255, 255, 0.25));
                transform: scale(1);
                -webkit-text-stroke: 1.5px rgba(255, 255, 255, 0.5);
            }
        }

        /* === Logo — 3D Zoomed Style (matching sub goal) === */
        .logo-layer {
            position: absolute;
            inset: 0;
            clip-path: url(#dock-inner);
            z-index: 6;
            pointer-events: none;
            overflow: hidden;
        }

        .watermark-logo {
            position: absolute;
            left: 15px;
            bottom: -70px;
            width: 200px;
            height: auto;
            opacity: 0.25;
            pointer-events: none;
            transform: rotate(-10deg) scale(1.1);
            filter: brightness(1.3) drop-shadow(0 4px 8px rgba(0, 0, 0, 0.6));
            -webkit-mask-image: linear-gradient(to right, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0) 100%);
            mask-image: linear-gradient(to right, rgba(0, 0, 0, 1) 0%, rgba(0, 0, 0, 0) 100%);
        }
    </style>
</head>

<body>

    <!--
        Both clip-paths use the SAME 650x70 coordinate system.
        The inner path is uniformly 3px inset from the outer path
        on all edges (top, left, right, corners, inverse curves).
        Bottom edge has no inset (flush with screen).
    -->
    <svg width="0" height="0" style="position: absolute;">
        <defs>
            <!-- OUTER shape: rounded top + inverse curves at bottom -->
            <clipPath id="dock-outer" clipPathUnits="userSpaceOnUse">
                <path d="
                    M 55 0
                    L 595 0
                    C 612 0, 625 13, 625 30
                    L 625 45
                    C 625 59, 637 70, 650 70
                    L 0 70
                    C 13 70, 25 59, 25 45
                    L 25 30
                    C 25 13, 38 0, 55 0
                    Z" />
            </clipPath>

            <!-- INNER shape: 4px inset from outer on top, left, right.
                 No inset on bottom (flush). -->
            <clipPath id="dock-inner" clipPathUnits="userSpaceOnUse">
                <path d="
                    M 55 4
                    L 595 4
                    C 608 4, 621 17, 621 30
                    L 621 45
                    C 621 57, 633 70, 646 70
                    L 4 70
                    C 17 70, 29 57, 29 45
                    L 29 30
                    C 29 17, 42 4, 55 4
                    Z" />
            </clipPath>
        </defs>
    </svg>

    <div class="dock-anchor">
        <!-- Star border: fixed wrapper clips to dock shape, gradient spins inside -->
        <div class="star-border-wrapper">
            <div class="star-border"></div>
        </div>

        <!-- Inner shape = the dark fill (covers outer, leaving 3px border) -->
        <div class="inner-shape">
            <div id="progress-fill" class="progress-fill">
                <div class="fill-glow"></div>
            </div>
        </div>

        <!-- Logo on its own layer (not clipped by inner-shape overflow) -->
        <div class="logo-layer">
            <img src="../Logo/Logo.png" class="watermark-logo" alt="logo">
        </div>

        <!-- Glossy glass overlay -->
        <div class="glass-overlay"></div>

        <!-- Rim Light SVG Layer -->
        <div class="rim-light-layer" style="clip-path: url(#dock-outer);">
            <svg viewBox="0 0 650 70">
                <defs>
                    <linearGradient id="rim-grad-sub" x1="0%" y1="0%" x2="0%" y2="100%">
                        <stop offset="0%" stop-color="white" stop-opacity="0.95" />
                        <stop offset="30%" stop-color="white" stop-opacity="0.52" />
                        <stop offset="100%" stop-color="white" stop-opacity="0" />
                    </linearGradient>
                    <filter id="rim-blur-sub">
                        <feGaussianBlur stdDeviation="0.28" />
                    </filter>
                </defs>
                <path class="rim-path" d="
                    M 36 11
                    C 38 6.2, 44 3.8, 52 3.8
                    L 598 3.8
                    C 606 3.8, 612 6.2, 614 11" stroke="url(#rim-grad-sub)" stroke-width="1.35" fill="none" filter="url(#rim-blur-sub)"
                    stroke-linecap="round" />
            </svg>
        </div>

        <!-- Text content -->
        <div class="content-wrapper" id="content-wrapper">
            <div class="label-group">
                <div class="label">SUB GOAL</div>
                <div id="completed-tag" class="completed-tag">COMPLETED</div>
            </div>
            <div class="numbers" id="number-group">
                <span id="current-val" class="current-val">00</span>
                <span class="divider">/</span>
                <span id="target-val" class="target-val">50</span>
            </div>
        </div>
    </div>

    <script>
        let TARGET_GOAL = 50;
        const POLL_INTERVAL = 300; // Faster polling for better "gift" responsiveness

        function updateProgressBar(current) {
            const fill = document.getElementById('progress-fill');
            const wrapper = document.getElementById('content-wrapper');
            const numGroup = document.getElementById('number-group');
            const tag = document.getElementById('completed-tag');

            const percentage = Math.min((current / TARGET_GOAL) * 100, 100);
            fill.style.width = percentage + '%';

            if (percentage > 0) {
                fill.classList.add('fill-active');
            } else {
                fill.classList.remove('fill-active');
            }

            // COMPLETION LOGIC
            if (current >= TARGET_GOAL) {
                wrapper.classList.add('completed');
                tag.style.display = 'block';
            } else {
                wrapper.classList.remove('completed');
                tag.style.display = 'none';
            }
        }

        function triggerPop() {
            const el = document.getElementById('current-val');
            el.classList.remove("current-flash");
            void el.offsetWidth; // Force Reflow
            el.classList.add("current-flash");
        }

        let lastCount = -1;
        let lastEventId = '';

        window.updateFollowers = function (val, top, id) {
            const current = parseInt(val) || 0;

            // Allow animation trigger if ID is different (Spam detection)
            const isNewEvent = id && id !== lastEventId;
            const isNewCount = current !== lastCount;

            if (isNewCount || isNewEvent) {
                const el = document.getElementById('current-val');
                el.textContent = current.toLocaleString('en-US', { minimumIntegerDigits: 2 });

                // Trigger pop for any update after initial load
                if (lastCount !== -1) {
                    triggerPop();
                }

                updateProgressBar(current);
                lastCount = current;
                if (id) lastEventId = id;
            }
        };

        document.getElementById('target-val').textContent = TARGET_GOAL;

        function injectScript(filename, id) {
            const old = document.getElementById(id);
            if (old) old.remove();
            const s = document.createElement("script");
            // Cache busting for frequent updates
            s.src = filename + "?t=" + Date.now();
            s.id = id;
            document.body.appendChild(s);
        }

        function poll() {
            injectScript("../Data/data_followers.js", "script-followers");
        }

        setInterval(poll, POLL_INTERVAL);
        poll();

        /* === Resolution-independent scaling ===
           Scales the dock to maintain the same visual size at any resolution.
           Designed at 1920px wide — at 3840px it renders 2x crisp, same visual size. */
        const BASE_WIDTH = 1920;
        function adjustScale() {
            const scale = window.innerWidth / BASE_WIDTH;
            const anchor = document.querySelector('.dock-anchor');
            anchor.style.transform = 'translateX(-50%) scale(' + scale + ')';
            anchor.style.transformOrigin = 'bottom center';
            window.addEventListener('resize', adjustScale);
        }
        window.addEventListener('resize', adjustScale);
        adjustScale();
    </script>

    <script src="../Settings/settings.js"></script>
    <script src="../Data/data_subs.js"></script>

    <!-- Color Settings Loader -->
    <script>
        (function () {
            // ╔══════════════════════════════════════════════════════════════════╗
            // ║              EMBEDDED SMOOTH HUE ENGINE                         ║
            // ╚══════════════════════════════════════════════════════════════════╝

            const BASE_COLORS = {
                '--border-glow-color': 'rgba(10, 255, 10, 0.4)',
                '--label-glow': 'rgba(10, 255, 10, 0.3)',
                '--fill-start': 'rgba(5, 60, 50, 0.95)',
                '--fill-mid': 'rgba(10, 100, 80, 0.95)',
                '--fill-mid2': 'rgba(30, 170, 80, 0.95)',
                '--fill-end': 'rgba(50, 220, 100, 0.95)',
                '--label-hue-glow': 'rgba(56, 239, 125, 0.18)',
                '--fill-glow-color': 'rgba(56, 239, 125, 0.4)'
            };

            const State = {
                currentHue: 0,
                targetHue: 0,
                animationFrame: null
            };

            function lerp(start, end, factor) {
                return start + (end - start) * factor;
            }

            function animate() {
                const diff = State.targetHue - State.currentHue;
                if (Math.abs(diff) > 0.05) {
                    State.currentHue = lerp(State.currentHue, State.targetHue, 0.08);
                    updateColors();
                    State.animationFrame = requestAnimationFrame(animate);
                } else if (Math.abs(diff) > 0) {
                    State.currentHue = State.targetHue;
                    updateColors();
                    State.animationFrame = null;
                } else {
                    State.animationFrame = null;
                }
            }

            function updateColors() {
                if (!window.adjustHue) return;
                const style = document.documentElement.style;

                // 1. Core Theme Colors
                const themeHue = State.currentHue;
                const themeShade = window.GLOBAL_COLOR_BRIGHTNESS !== undefined ? window.GLOBAL_COLOR_BRIGHTNESS : 1.0;
                const themeSat = window.GLOBAL_COLOR_SATURATION !== undefined ? window.GLOBAL_COLOR_SATURATION : 1.0;

                for (const key in BASE_COLORS) {
                    const oldShade = window.GLOBAL_COLOR_BRIGHTNESS;
                    const oldSat = window.GLOBAL_COLOR_SATURATION;
                    window.GLOBAL_COLOR_BRIGHTNESS = themeShade;
                    window.GLOBAL_COLOR_SATURATION = themeSat;
                    style.setProperty(key, window.adjustHue(BASE_COLORS[key], themeHue));
                    window.GLOBAL_COLOR_BRIGHTNESS = oldShade;
                    window.GLOBAL_COLOR_SATURATION = oldSat;
                }

                // 2. Star Border Individualism
                const starHue = window.STAR_HUE_OFFSET !== undefined ? window.STAR_HUE_OFFSET : 0;
                const starShade = window.STAR_COLOR_BRIGHTNESS !== undefined ? window.STAR_COLOR_BRIGHTNESS : 1.0;
                const starSat = window.STAR_COLOR_SATURATION !== undefined ? window.STAR_COLOR_SATURATION : 1.0;
                const starHue2 = window.STAR_SECONDARY_HUE_OFFSET !== undefined ? window.STAR_SECONDARY_HUE_OFFSET : (starHue + 205);
                const starShade2 = window.STAR_SECONDARY_COLOR_BRIGHTNESS !== undefined ? window.STAR_SECONDARY_COLOR_BRIGHTNESS : 1.6;
                const starSat2 = window.STAR_SECONDARY_COLOR_SATURATION !== undefined ? window.STAR_SECONDARY_COLOR_SATURATION : 1.0;
                const starOffset2 = window.STAR_SECONDARY_OFFSET_DEG !== undefined ? window.STAR_SECONDARY_OFFSET_DEG : 120;
                const spin = window.STAR_SPIN_SPEED !== undefined ? window.STAR_SPIN_SPEED : 10.0;

                const oldShade = window.GLOBAL_COLOR_BRIGHTNESS;
                const oldSat = window.GLOBAL_COLOR_SATURATION;
                window.GLOBAL_COLOR_BRIGHTNESS = starShade;
                window.GLOBAL_COLOR_SATURATION = starSat;
                style.setProperty('--star-color', window.adjustHue('rgb(10, 255, 10)', starHue));
                style.setProperty('--star-color-soft', window.adjustHue('rgba(10, 255, 10, 0.1)', starHue));
                window.GLOBAL_COLOR_BRIGHTNESS = starShade2;
                window.GLOBAL_COLOR_SATURATION = starSat2;
                style.setProperty('--star-color-secondary', window.adjustHue('rgb(10, 255, 10)', starHue2));
                style.setProperty('--star-color-secondary-soft', window.adjustHue('rgba(10, 255, 10, 0.14)', starHue2));
                style.setProperty('--star-secondary-offset', `${starOffset2}deg`);
                style.setProperty('--spin-speed', `${Math.max(2, spin)}s`);
                window.GLOBAL_COLOR_BRIGHTNESS = oldShade;
                window.GLOBAL_COLOR_SATURATION = oldSat;
            }

            function loadSettings() {
                const old = document.getElementById('settings-script');
                if (old) old.remove();

                const s = document.createElement('script');
                s.src = '../Settings/settings.js?t=' + Date.now();
                s.id = 'settings-script';
                s.onload = function () {
                    // Update target goal from settings
                    if (window.SUB_GOAL_CONFIG) {
                        TARGET_GOAL = window.SUB_GOAL_CONFIG;
                        document.getElementById('target-val').textContent = TARGET_GOAL;
                        updateProgressBar(lastCount);
                    }

                    const newTarget = window.GLOBAL_HUE_OFFSET || 0;
                    if (newTarget !== State.targetHue) {
                        State.targetHue = newTarget;
                        if (!State.animationFrame) animate();
                    }

                    applyFilters();
                    updateColors();
                };
                document.head.appendChild(s);
            }

            function applyFilters() {
                const bright = window.GLOBAL_BRIGHTNESS !== undefined ? window.GLOBAL_BRIGHTNESS : 1.0;
                const gloss = window.GLOSSY_INTENSITY !== undefined ? window.GLOSSY_INTENSITY : 1.0;
                const glossMapped = gloss >= 1
                    ? (1 + Math.pow(gloss - 1, 1.35) * 2.2)
                    : Math.max(0, 1 - Math.pow(1 - gloss, 0.75) * 1.15);
                const rimValue = window.RIM_LIGHT_INTENSITY !== undefined ? window.RIM_LIGHT_INTENSITY : 1.0;
                const rimIntensity = rimValue >= 1
                    ? Math.min(2.2, 1 + Math.pow(rimValue - 1, 1.15) * 0.9)
                    : Math.max(0.25, 1 - Math.pow(1 - rimValue, 0.85) * 0.75);
                const glow = window.GLOW_SUB_DOCK !== false;
                const showBorder = window.SHOW_BORDER_SUB_DOCK !== false;

                document.documentElement.style.filter = `brightness(${bright})`;
                document.documentElement.style.setProperty('--gloss-intensity', glossMapped);
                document.documentElement.style.setProperty('--rim-light-intensity', rimIntensity);

                const starWrapper = document.querySelector('.star-border-wrapper');
                const anchor = document.querySelector('.dock-anchor');
                const rim = document.querySelector('.rim-light-layer');
                const fillGlow = document.querySelector('.fill-glow');
                if (starWrapper) starWrapper.style.opacity = glow ? '1' : '0';
                if (anchor) anchor.style.filter = glow ? 'drop-shadow(0 -4px 15px rgba(0, 0, 0, 0.5))' : 'none';
                if (rim) rim.style.opacity = glow ? String(rimIntensity) : '0';
                if (fillGlow) fillGlow.style.opacity = glow ? '' : '0';

                // Border Toggle Logic
                const innerElements = document.querySelectorAll('.inner-shape, .glass-overlay');
                innerElements.forEach(el => {
                    el.style.clipPath = showBorder ? 'url(#dock-inner)' : 'url(#dock-outer)';
                });
            }

            loadSettings();
            setInterval(loadSettings, 300);
        })();
    </script>
</body>

</html>
