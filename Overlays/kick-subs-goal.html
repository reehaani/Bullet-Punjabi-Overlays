<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Kick Sub Goal</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Anton&family=Inter:wght@400;700;900&display=swap');

        @property --star-color {
            syntax: '<color>';
            inherits: true;
            initial-value: #0aff0a;
        }

        @property --star-color-soft {
            syntax: '<color>';
            inherits: true;
            initial-value: rgba(10, 255, 10, 0.1);
        }

        @property --star-color-secondary {
            syntax: '<color>';
            inherits: true;
            initial-value: rgba(31, 186, 255, 1);
        }

        @property --star-color-secondary-soft {
            syntax: '<color>';
            inherits: true;
            initial-value: rgba(31, 186, 255, 0.14);
        }

        @property --star-secondary-offset {
            syntax: '<angle>';
            inherits: true;
            initial-value: 120deg;
        }

        :root {
            --fill-start: rgba(5, 60, 50, 0.95);
            --fill-mid: rgba(10, 100, 80, 0.95);
            --fill-mid2: rgba(30, 170, 80, 0.95);
            --fill-end: rgba(50, 220, 100, 0.95);
            --bar-fill-bg: linear-gradient(to right, var(--fill-start), var(--fill-mid) 40%, var(--fill-mid2) 75%, var(--fill-end));
            --fill-glow-color: rgba(56, 239, 125, 0.4);
            --star-color: #0aff0a;
            --star-color-soft: rgba(10, 255, 10, 0.1);
            --star-color-secondary: rgba(31, 186, 255, 1);
            --star-color-secondary-soft: rgba(31, 186, 255, 0.14);
            --star-secondary-offset: 120deg;
            --spin-speed: 10s;
            --track-bg: rgba(0, 0, 0, 0.85);
            --gloss-intensity: 1;
            --rim-light-intensity: 1;
            transition:
                --star-color 320ms linear,
                --star-color-soft 320ms linear,
                --star-color-secondary 320ms linear,
                --star-color-secondary-soft 320ms linear,
                --star-secondary-offset 320ms ease;
        }

        * {
            box-sizing: border-box;
            transition: background-color 1s ease, color 1s ease, border-color 1s ease, box-shadow 1s ease;
        }

        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            background: transparent;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Inter', sans-serif;
        }

        .goal-container {
            position: relative;
            width: 500px;
            height: 70px;
            border-radius: 35px;
            background: var(--track-bg);
            box-shadow:
                0 0 28px rgba(0, 0, 0, 0.6);
            overflow: hidden;
        }

        .star-border-wrapper {
            position: absolute;
            inset: 0;
            border-radius: 35px;
            overflow: hidden;
            z-index: 1;
        }

        .star-border {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 1200px;
            height: 1200px;
            margin-left: -600px;
            margin-top: -600px;
            background: conic-gradient(from 0deg,
                    transparent 0deg,
                    var(--star-color-soft) 8deg,
                    var(--star-color) 30deg,
                    var(--star-color-soft) 52deg,
                    transparent 62deg,
                    transparent 360deg);
            animation: spin var(--spin-speed) linear infinite;
            -webkit-mask-image: radial-gradient(circle, transparent 20px, black 25px);
            mask-image: radial-gradient(circle, transparent 20px, black 25px);
        }

        .star-border::before {
            content: '';
            position: absolute;
            inset: 0;
            background: conic-gradient(from 0deg,
                    transparent 0deg,
                    var(--star-color-secondary-soft) 8deg,
                    var(--star-color-secondary) 30deg,
                    var(--star-color-secondary-soft) 52deg,
                    transparent 62deg,
                    transparent 360deg);
            transform: rotate(var(--star-secondary-offset));
            z-index: 2;
        }

        .star-border::after {
            content: '';
            position: absolute;
            inset: 0;
            background: inherit;
            filter: blur(18px);
            opacity: 0.8;
            z-index: 1;
        }

        .rim-light-layer {
            position: absolute;
            inset: 0;
            border-radius: 35px;
            z-index: 4;
            pointer-events: none;
            opacity: var(--rim-light-intensity, 1);
            -webkit-mask-image: linear-gradient(to bottom, #000 0%, #000 62%, transparent 88%, transparent 100%);
            mask-image: linear-gradient(to bottom, #000 0%, #000 62%, transparent 88%, transparent 100%);
        }

        .rim-light-layer::before {
            content: '';
            position: absolute;
            top: 1px;
            left: 18px;
            right: 18px;
            height: 2px;
            border-radius: 999px;
            background: linear-gradient(90deg,
                    rgba(255, 255, 255, 0.06) 0%,
                    rgba(255, 255, 255, 0.92) 42%,
                    rgba(255, 255, 255, 0.5) 78%,
                    rgba(255, 255, 255, 0.08) 100%);
            filter: blur(0.3px) drop-shadow(0 0 6px rgba(255, 255, 255, 0.35));
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .inner-bar-track {
            position: absolute;
            inset: 4px;
            border-radius: 31px;
            background: rgb(20, 20, 20);
            z-index: 2;
            overflow: hidden;
            box-shadow:
                inset 0 0 0 1px rgba(0, 0, 0, 0.8);
        }

        .progress-fill {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: var(--bar-fill-bg);
            transition: width 1.25s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 3;
            overflow: hidden;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.16) 0%,
                    rgba(255, 255, 255, 0.04) 28%,
                    transparent 52%,
                    rgba(0, 0, 0, 0.22) 100%);
            box-shadow:
                inset 0 2px 2px rgba(255, 255, 255, 0.4),
                inset 0 -2px 4px rgba(0, 0, 0, 0.3),
                inset 0 0 14px var(--fill-glow-color);
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 60%;
            height: 100%;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(255, 255, 255, 0.03) 30%,
                    rgba(255, 255, 255, 0.15) 50%,
                    rgba(255, 255, 255, 0.03) 70%,
                    transparent 100%);
            animation: shine-sweep 3s ease-in-out infinite;
        }

        @keyframes shine-sweep {
            0% {
                left: -100%;
            }

            100% {
                left: 200%;
            }
        }

        .fill-glow {
            position: absolute;
            right: -10px;
            top: 0;
            height: 100%;
            width: 20px;
            background: var(--fill-end);
            filter: blur(10px);
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 4;
        }

        .fill-active {
            box-shadow: 10px 0 24px var(--fill-glow-color);
        }

        .fill-active .fill-glow {
            opacity: 0.85;
        }

        .mustache-bg {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 6;
            opacity: 0.24;
            pointer-events: none;
        }

        .mustache-bg img {
            width: 280px;
            height: auto;
            filter: brightness(0) invert(1);
            transform: translateY(-30px);
            -webkit-mask-image: radial-gradient(ellipse at center, black 40%, transparent 80%);
            mask-image: radial-gradient(ellipse at center, black 40%, transparent 80%);
        }

        .glass-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to bottom,
                    rgba(255, 255, 255, 0.12) 0%,
                    rgba(255, 255, 255, 0.05) 24%,
                    transparent 45%,
                    rgba(0, 0, 0, 0.14) 100%);
            z-index: 15;
            pointer-events: none;
            filter: brightness(var(--gloss-intensity, 1)) contrast(var(--gloss-intensity, 1));
            opacity: 0.62;
        }

        .content-wrapper {
            position: absolute;
            inset: 0;
            z-index: 20;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 26px;
            pointer-events: none;
        }

        .label-group {
            position: relative;
            left: auto;
            transform: none;
            display: flex;
            align-items: center;
            gap: 10px;
            white-space: nowrap;
            flex: 0 1 auto;
        }

        .label {
            font-family: 'Anton', sans-serif;
            font-size: 31px;
            letter-spacing: 2px;
            text-transform: uppercase;
            background: linear-gradient(180deg,
                    #ffffff 0%, #ffffff 20%,
                    #e0e0e0 40%, #a0a0a0 55%,
                    #c8c8c8 70%, #ffffff 85%, #e0e0e0 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            -webkit-text-stroke: 1.2px rgba(255, 255, 255, 0.45);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1)) drop-shadow(0 0 10px rgba(255, 255, 255, 0.2));
        }

        .completed-tag {
            font-family: 'Anton', sans-serif;
            font-size: 18px;
            color: #000;
            background: linear-gradient(135deg, #ffed8a, #d4af37, #8a6d3b);
            padding: 2px 10px;
            border-radius: 6px;
            text-transform: uppercase;
            display: none;
            animation: tag-pop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) both;
            box-shadow: 0 0 16px rgba(212, 175, 55, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.25);
        }

        @keyframes tag-pop {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .numbers {
            font-family: 'Anton', sans-serif;
            font-size: 34px;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .current-val,
        .target-val {
            background: linear-gradient(180deg,
                    #ffffff 0%, #ffffff 20%,
                    #e0e0e0 40%, #a0a0a0 55%,
                    #c8c8c8 70%, #ffffff 85%, #e0e0e0 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            -webkit-text-stroke: 1px rgba(255, 255, 255, 0.45);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1));
        }

        .target-val {
            opacity: 0.84;
            font-size: 28px;
        }

        .divider {
            color: #dcdcdc;
            -webkit-text-stroke: 0;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1));
        }

        .content-wrapper.completed .label,
        .content-wrapper.completed .current-val,
        .content-wrapper.completed .target-val {
            background: linear-gradient(180deg,
                    #ffed8a 0%,
                    #fcd04d 25%,
                    #d4af37 50%,
                    #8a6d3b 75%,
                    #d4af37 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            color: transparent;
            -webkit-text-stroke: 1px rgba(255, 230, 0, 0.35);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.85)) drop-shadow(0 0 14px rgba(212, 175, 55, 0.75));
        }

        .content-wrapper.completed {
            justify-content: center;
            gap: 16px;
        }

        .current-flash {
            animation: current-pop 0.75s cubic-bezier(0.16, 1, 0.3, 1) both !important;
        }

        @keyframes current-pop {
            0% {
                filter: drop-shadow(0 0 20px #fff) drop-shadow(0 0 34px #fff);
                transform: scale(1.12);
            }

            100% {
                filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1));
                transform: scale(1);
            }
        }

        .text-glow {
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 1)) drop-shadow(0 0 10px var(--fill-glow-color)) !important;
        }
    </style>
</head>

<body>

    <div class="goal-container" id="goal-container">
        <div class="star-border-wrapper">
            <div class="star-border"></div>
        </div>
        <div class="rim-light-layer"></div>

        <div class="inner-bar-track">
            <div id="progress-fill" class="progress-fill">
                <div class="fill-glow"></div>
            </div>

            <div class="mustache-bg">
                <img src="../Logo/Logo 2.png" alt="Mustache Background">
            </div>

            <div class="glass-overlay"></div>

            <div class="content-wrapper" id="content-wrapper">
                <div class="label-group">
                    <div class="label" id="subgoal-label">SUB GOAL</div>
                    <div id="completed-tag" class="completed-tag">COMPLETED</div>
                </div>
                <div class="numbers" id="number-group">
                    <span id="current-val" class="current-val">00</span>
                    <span class="divider">/</span>
                    <span id="target-val" class="target-val">50</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        let TARGET_GOAL = 50;
        const POLL_INTERVAL = 300;

        let lastCount = -1;
        let lastEventId = '';

        function formatCount(value) {
            return Number(value || 0).toLocaleString('en-US', { minimumIntegerDigits: 2 });
        }

        function updateProgressBar(current) {
            const fill = document.getElementById('progress-fill');
            const wrapper = document.getElementById('content-wrapper');
            const tag = document.getElementById('completed-tag');

            const safeGoal = Math.max(1, TARGET_GOAL);
            const percentage = Math.min((current / safeGoal) * 100, 100);
            fill.style.width = percentage + '%';

            if (percentage > 0) fill.classList.add('fill-active');
            else fill.classList.remove('fill-active');

            if (current >= TARGET_GOAL) {
                wrapper.classList.add('completed');
                tag.style.display = 'block';
            } else {
                wrapper.classList.remove('completed');
                tag.style.display = 'none';
            }
        }

        function triggerPop() {
            const el = document.getElementById('current-val');
            el.classList.remove('current-flash');
            void el.offsetWidth;
            el.classList.add('current-flash');
        }

        function updateGoalCounter(current, id) {
            const isNewEvent = id && id !== lastEventId;
            const isNewCount = current !== lastCount;
            if (!isNewEvent && !isNewCount) return;

            document.getElementById('current-val').textContent = formatCount(current);

            if (lastCount !== -1 && current !== lastCount) triggerPop();

            updateProgressBar(current);
            lastCount = current;
            if (id) lastEventId = id;
        }

        window.updateFollowers = function (val, extra, id) {
            const current = parseInt(val, 10) || 0;
            updateGoalCounter(current, id);
        };

        function setTarget(value) {
            TARGET_GOAL = Math.max(1, parseInt(value, 10) || 50);
            document.getElementById('target-val').textContent = TARGET_GOAL.toLocaleString('en-US');
            updateProgressBar(Math.max(0, lastCount));
        }

        function injectScript(filename, id) {
            const old = document.getElementById(id);
            if (old) old.remove();
            const s = document.createElement('script');
            s.src = filename + '?t=' + Date.now();
            s.id = id;
            document.body.appendChild(s);
        }

        function poll() {
            injectScript('../Data/data_followers.js', 'script-followers');
        }

        setInterval(poll, POLL_INTERVAL);
        poll();

        setTarget(TARGET_GOAL);
    </script>

    <script>
        (function () {
            const BASE_COLORS = {
                '--fill-start': 'rgba(5, 60, 50, 0.95)',
                '--fill-mid': 'rgba(10, 100, 80, 0.95)',
                '--fill-mid2': 'rgba(30, 170, 80, 0.95)',
                '--fill-end': 'rgba(50, 220, 100, 0.95)',
                '--fill-glow-color': 'rgba(56, 239, 125, 0.4)'
            };

            const State = { currentHue: 0, targetHue: 0, animationFrame: null };

            function lerp(a, b, t) {
                return a + (b - a) * t;
            }

            function animateHue() {
                const diff = State.targetHue - State.currentHue;
                if (Math.abs(diff) > 0.05) {
                    State.currentHue = lerp(State.currentHue, State.targetHue, 0.08);
                    updateColors();
                    State.animationFrame = requestAnimationFrame(animateHue);
                } else {
                    State.currentHue = State.targetHue;
                    updateColors();
                    State.animationFrame = null;
                }
            }

            function updateColors() {
                if (!window.adjustHue) return;
                const style = document.documentElement.style;
                const hue = State.currentHue;
                const shade = window.GLOBAL_COLOR_BRIGHTNESS !== undefined ? window.GLOBAL_COLOR_BRIGHTNESS : 1.0;
                const sat = window.GLOBAL_COLOR_SATURATION !== undefined ? window.GLOBAL_COLOR_SATURATION : 1.0;

                for (const key in BASE_COLORS) {
                    const oldShade = window.GLOBAL_COLOR_BRIGHTNESS;
                    const oldSat = window.GLOBAL_COLOR_SATURATION;
                    window.GLOBAL_COLOR_BRIGHTNESS = shade;
                    window.GLOBAL_COLOR_SATURATION = sat;
                    style.setProperty(key, window.adjustHue(BASE_COLORS[key], hue));
                    window.GLOBAL_COLOR_BRIGHTNESS = oldShade;
                    window.GLOBAL_COLOR_SATURATION = oldSat;
                }

                const starHue = window.STAR_HUE_OFFSET !== undefined ? window.STAR_HUE_OFFSET : 0;
                const starShade = window.STAR_COLOR_BRIGHTNESS !== undefined ? window.STAR_COLOR_BRIGHTNESS : 1.0;
                const starSat = window.STAR_COLOR_SATURATION !== undefined ? window.STAR_COLOR_SATURATION : 1.0;
                const starHue2 = window.STAR_SECONDARY_HUE_OFFSET !== undefined ? window.STAR_SECONDARY_HUE_OFFSET : (starHue + 205);
                const starShade2 = window.STAR_SECONDARY_COLOR_BRIGHTNESS !== undefined ? window.STAR_SECONDARY_COLOR_BRIGHTNESS : 1.6;
                const starSat2 = window.STAR_SECONDARY_COLOR_SATURATION !== undefined ? window.STAR_SECONDARY_COLOR_SATURATION : 1.0;
                const starOffset2 = window.STAR_SECONDARY_OFFSET_DEG !== undefined ? window.STAR_SECONDARY_OFFSET_DEG : 120;
                const spin = window.STAR_SPIN_SPEED !== undefined ? window.STAR_SPIN_SPEED : 10.0;
                const oldShade = window.GLOBAL_COLOR_BRIGHTNESS;
                const oldSat = window.GLOBAL_COLOR_SATURATION;
                window.GLOBAL_COLOR_BRIGHTNESS = starShade;
                window.GLOBAL_COLOR_SATURATION = starSat;
                style.setProperty('--star-color', window.adjustHue('rgb(10, 255, 10)', starHue));
                style.setProperty('--star-color-soft', window.adjustHue('rgba(10, 255, 10, 0.1)', starHue));
                window.GLOBAL_COLOR_BRIGHTNESS = starShade2;
                window.GLOBAL_COLOR_SATURATION = starSat2;
                style.setProperty('--star-color-secondary', window.adjustHue('rgb(10, 255, 10)', starHue2));
                style.setProperty('--star-color-secondary-soft', window.adjustHue('rgba(10, 255, 10, 0.14)', starHue2));
                style.setProperty('--star-secondary-offset', `${starOffset2}deg`);
                style.setProperty('--spin-speed', `${Math.max(2, spin)}s`);
                window.GLOBAL_COLOR_BRIGHTNESS = oldShade;
                window.GLOBAL_COLOR_SATURATION = oldSat;
            }

            function loadSettings() {
                const old = document.getElementById('settings-script');
                if (old) old.remove();

                const s = document.createElement('script');
                s.src = '../Settings/settings.js?t=' + Date.now();
                s.id = 'settings-script';
                s.onload = function () {
                    if (window.SUB_GOAL_CONFIG) {
                        const val = parseInt(window.SUB_GOAL_CONFIG, 10);
                        if (!Number.isNaN(val)) {
                            TARGET_GOAL = Math.max(1, val);
                            document.getElementById('target-val').textContent = TARGET_GOAL.toLocaleString('en-US');
                            updateProgressBar(Math.max(0, lastCount));
                        }
                    }

                    const next = window.GLOBAL_HUE_OFFSET || 0;
                    if (next !== State.targetHue) {
                        State.targetHue = next;
                        if (!State.animationFrame) animateHue();
                    }

                    applyFilters();
                    updateColors();
                };
                document.head.appendChild(s);
            }

            function applyFilters() {
                const bright = window.GLOBAL_BRIGHTNESS !== undefined ? window.GLOBAL_BRIGHTNESS : 1.0;
                const gloss = window.GLOSSY_INTENSITY !== undefined ? window.GLOSSY_INTENSITY : 1.0;
                const glossMapped = gloss >= 1
                    ? (1 + Math.pow(gloss - 1, 1.35) * 2.2)
                    : Math.max(0, 1 - Math.pow(1 - gloss, 0.75) * 1.15);
                const rimValue = window.RIM_LIGHT_INTENSITY !== undefined ? window.RIM_LIGHT_INTENSITY : 1.0;
                const rimIntensity = rimValue >= 1
                    ? Math.min(2.2, 1 + Math.pow(rimValue - 1, 1.15) * 0.9)
                    : Math.max(0.25, 1 - Math.pow(1 - rimValue, 0.85) * 0.75);
                const glow = window.GLOW_SUB_RECT !== false;

                document.documentElement.style.filter = `brightness(${bright})`;
                document.documentElement.style.setProperty('--gloss-intensity', glossMapped);
                document.documentElement.style.setProperty('--rim-light-intensity', rimIntensity);

                const starWrap = document.querySelector('.star-border-wrapper');
                const rim = document.querySelector('.rim-light-layer');
                if (starWrap) starWrap.style.opacity = glow ? '1' : '0';
                if (rim) rim.style.opacity = glow ? String(rimIntensity) : '0';

                const label = document.getElementById('subgoal-label');
                const numbers = document.getElementById('number-group');
                if (glow) {
                    if (label) label.classList.add('text-glow');
                    if (numbers) numbers.classList.add('text-glow');
                } else {
                    if (label) label.classList.remove('text-glow');
                    if (numbers) numbers.classList.remove('text-glow');
                }
            }

            loadSettings();
            setInterval(loadSettings, 300);
        })();
    </script>
</body>

</html>
